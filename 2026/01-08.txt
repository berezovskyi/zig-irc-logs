1767830433
andrewrk!~andrewrk@mail.ziglang.org
bblack: happy to hear that. yes it really is quite satisfying to make commits like this one: c8ecfad41a322260fae38a4115a94345ed9f94b7

1767830445
andrewrk!~andrewrk@mail.ziglang.org
https://codeberg.org/ziglang/zig/commit/c8ecfad41a322260fae38a4115a94345ed9f94b7

1767831657
ifreund!2940d10f8b@user/ifreund
I need to play around with integrating c libraries into the std.Io event loop eventually

1767831675
ifreund!2940d10f8b@user/ifreund
(specifically libwayland/wlroots)

1767832169
andrewrk!~andrewrk@mail.ziglang.org
ifreund: does it have a mechanism for that? if it's making direct calls to blocking, dynamically linked libc functions, I'm not sure there's any way to integrate 

1767832233
andrewrk!~andrewrk@mail.ziglang.org
I'm curious what you have in mind

1767832305
andrewrk!~andrewrk@mail.ziglang.org
if linking statically and zig is providing libc, then we could in theory do automatic, transparent integration

1767832362
smlavine!~smlavine@sourcehut/user/smlavine
andrewrk: If I understand correctly with that commit, it won't clean up files in parallel, right? It'll just (possibly) run it in the background?

1767832434
andrewrk!~andrewrk@mail.ziglang.org
smlavine: that's right, it will clean up files concurrently with something else, but it doesn't try to parallelize deletion of files independently. however, that is something that deleteTree() is free to do internally

1767832474
ezzieyguywuf!~Unknown@user/ezzieyguywuf
what's new in zig? I've been out of the loop for a few months

1767832496
andrewrk!~andrewrk@mail.ziglang.org
oh boy... who wants to tell them

1767832545
ifreund!2940d10f8b@user/ifreund
andrewrk: libwayland gives you an fd you can add to your epoll call for example, plus some functions you have to call before polling/after polling returns for thread safety

1767832558
ezzieyguywuf!~Unknown@user/ezzieyguywuf
I know of writergate lol

1767832579
ezzieyguywuf!~Unknown@user/ezzieyguywuf
that was >a few months ago though wasn't it?

1767832579
ifreund!2940d10f8b@user/ifreund
I think this should be possible to integrate into any reasonable event loop in theory

1767832614
andrewrk!~andrewrk@mail.ziglang.org
ezzieyguywuf: we have async I/O now

1767832628
ifreund!2940d10f8b@user/ifreund
wlroots currently has a hard dependency on libwayland's default server event loop, but I have wlroots commit access and can probably push a more generic solution forward :D

1767832635
ezzieyguywuf!~Unknown@user/ezzieyguywuf
yooooooooo

1767832654
andrewrk!~andrewrk@mail.ziglang.org
in the last 2 months there have been 4302 files changed, 347113 insertions(+), 78893 deletions(-) in the zig git repository

1767832672
andrewrk!~andrewrk@mail.ziglang.org
unfortunately that number is skewed by adding cross compilation support for OpenBSD

1767832685
ezzieyguywuf!~Unknown@user/ezzieyguywuf
wow so much!

1767832692
ezzieyguywuf!~Unknown@user/ezzieyguywuf
0.15.1 seems to still be the latest release

1767832694
andrewrk!~andrewrk@mail.ziglang.org
ok in the standard library only, there have been 255 files changed, 45651 insertions(+), 33184 deletions(-) in the last 2 months

1767832783
ezzieyguywuf!~Unknown@user/ezzieyguywuf
ah rats, I forgot to get my employer to match my contributions to zig at the end of the year :(

1767832791
ezzieyguywuf!~Unknown@user/ezzieyguywuf
I bet I can do it retroactively though

1767832838
andrewrk!~andrewrk@mail.ziglang.org
ifreund: neat! well, I think jacobly has things to the point where you can start experimenting, in the io-uring-update branch

1767832930
ezzieyguywuf!~Unknown@user/ezzieyguywuf
oh wow, I'm interested in io uring and wayland

1767832935
ezzieyguywuf!~Unknown@user/ezzieyguywuf
so many neat things happening in here!

1767833057
goodtab!~admin@user/goodtab
are you using zig for anything rn ezzieyguywuf?

1767833058
ezzieyguywuf!~Unknown@user/ezzieyguywuf
looks like I need to change my upstream origin for zig too, though I'm not contributing (yet) so I guess it's not rly that critical

1767833091
ezzieyguywuf!~Unknown@user/ezzieyguywuf
goodtab: https://github.com/ezzieyguywuf/zcad this is my toy project though it's a bit neglected at the moment as, like I said earlier, I've stepped away for the past few months

1767833329
goodtab!~admin@user/goodtab
hey that's pretty neat, I checked out all the videos. makes me want to learn about computer graphics

1767833425
ezzieyguywuf!~Unknown@user/ezzieyguywuf
computer graphics are super fun!

1767833442
ezzieyguywuf!~Unknown@user/ezzieyguywuf
they can be a bit obtuse when you first start though, e.g. I wouldn't recommend starting with vulkan lol

1767833778
goodtab!~admin@user/goodtab
yeah I bet, a fun challenge nonetheless. I'll heed your advice about vulkan

1767836748
ezzieyguywuf!~Unknown@user/ezzieyguywuf
where can I start for messing with the new async I/O? just reading git commit messages or is there smthn better?

1767837800
andrewrk!~andrewrk@mail.ziglang.org
ezzieyguywuf: hmm yes we really should make an official guide for this stuff. in the meantime, I recommend to look at lib/std/Io/test.zig and lib/std/Io/Threaded/test.zig and read the doc comments in the std.Io interface

1767837811
andrewrk!~andrewrk@mail.ziglang.org
actually a good place to start would be reading through std.Io functions and doc comments

1767837905
andrewrk!~andrewrk@mail.ziglang.org
in particular, learning about async,concurrent,await,cancel (latter 2 are on Future)

1767837910
andrewrk!~andrewrk@mail.ziglang.org
then Group, and Queue

1767837923
andrewrk!~andrewrk@mail.ziglang.org
anything you can do in Go you can do better in Zig with std.Io

1767837945
andrewrk!~andrewrk@mail.ziglang.org
go func() is just shitty async that don't support cancel or return values

1767838469
ezzieyguywuf!~Unknown@user/ezzieyguywuf
sg thanks!

1767838513
ezzieyguywuf!~Unknown@user/ezzieyguywuf
anything you can do in Go you can do better in Zig with std.Io <- I was fully expecting this I've been excited about std.Io since you mentioned it in that one roadmap video (2025? 2024? I don't remember lol)

1767838565
ezzieyguywuf!~Unknown@user/ezzieyguywuf
go func() is just shitty async that don't support cancel or return values <- dude tell me about it. I'm currently trying to convince my team that throwing go func() aronud willy nilly is _not_ really a good idea, that it's important to be careful about dangling goroutines

1767838568
andrewrk!~andrewrk@mail.ziglang.org
feel free to ask how to do any specific thing here

1767838630
andrewrk!~andrewrk@mail.ziglang.org
right, in Go, `go func()` is "dangling" or "detached". in zig the equivalent is `Group.async` or `Group.concurrent`. you can make the Group global if you really want to get that "dangling" feeling

1767838630
ezzieyguywuf!~Unknown@user/ezzieyguywuf
will do! and what was that you mentioned about io-uring earlier? is that still WIP?

1767838653
andrewrk!~andrewrk@mail.ziglang.org
yeah it's wip

1767838676
andrewrk!~andrewrk@mail.ziglang.org
std.Io.Threaded is the most complete one right now. it supports robust cancelation on all operating systems

1767838703
ezzieyguywuf!~Unknown@user/ezzieyguywuf
cool. I'm guessing using epoll on linux?

1767838736
andrewrk!~andrewrk@mail.ziglang.org
nope it's threaded

1767838750
andrewrk!~andrewrk@mail.ziglang.org
did you know there is a way to unblock threads?

1767838800
ezzieyguywuf!~Unknown@user/ezzieyguywuf
interesting.

1767838802
ezzieyguywuf!~Unknown@user/ezzieyguywuf
no I didn't

1767838809
ezzieyguywuf!~Unknown@user/ezzieyguywuf
lots to catch up on!

1767838915
andrewrk!~andrewrk@mail.ziglang.org
with std.Io.Threaded, cancelation works by sending a signal to the thread that is running the task to be canceled. the signal handler is a no-op, but that is enough to interrupt any blocking syscall, making it return EINTR. that gives std.Io.Threaded a chance to check the cancel request flag

1767853917
goodtab!~admin@user/goodtab
https://i.ibb.co/jvjKB4x0/image.png almost finished with ziglings, no sleep til' 999

1767857954
goodtab!~admin@user/goodtab
and done. Well that was fun, hats off to everyone working on Ziglings. neat intro

1767860795
andrewrk!~andrewrk@mail.ziglang.org
congrats goodtab

1767876393
bblack!~bblack@wikimedia/bblack-WMF
so, I have one program which uses .processSpawn() for arbitrary user-defined external programs, and later does a .childWait() expecting them to exit within some timeout.  Obviously, these arbitrary other programs can be buggy, and may e.g. completely ignore SIGTERM and/or hang/loop indefinitely, but my program must be able to carry on cleanly if possible.

1767876508
bblack!~bblack@wikimedia/bblack-WMF
so the pattern I implemented in the application layer is more or less: io.concurrent() launches a thread for each child, and within that: processSpawn() the child, io.concurrent(fn { sleep(timeout); posix.kill(child.handle, .KILL); }, child.wait()

1767876757
bblack!~bblack@wikimedia/bblack-WMF
and now I'm trying to imagine if it makes sense to abstract that as an std.process.Child interface, and how these concepts map to e.g. Windows (or not)

1767876868
bblack!~bblack@wikimedia/bblack-WMF
something like a process.Child.waitDeadline() that also takes a timeout argument, and does the io.concurrent(sleep; KILL) internally before hanging in .wait()

1767877089
bblack!~bblack@wikimedia/bblack-WMF
you could similarly have a .killDeadline() for cases where you expect SIGTERM to work, but want a deadline-slept concurrent SIGKILL before the wait.

1767877144
bblack!~bblack@wikimedia/bblack-WMF
(whereas waitDeadline() is for processes that were supposed to be short-lived and exit on their own without an initial SIGTERM, but the sleep-kill safety concept is the same in the end)

1767885819
mimivalsi!~mimivalsi@user/MimiValsi
Any has worked with pgsql socket? I'm stuck in bind message. I want to send binary of age: isize = 30; The problem it's that isize = 8 bytes (64bits) and then I send my age value but pgsql will litterally read 8 bytes. But the field parameter must be a int32.

1767885888
mimivalsi!~mimivalsi@user/MimiValsi
anyone*

1767886026
mimivalsi!~mimivalsi@user/MimiValsi
atm doing it with mem.writeInt(i32, &buf, @sizeOf(isize), .big);, append to arrayList, writeInt(i32, &buf, age, .big); and at last append to arrayList.

1767886155
Smithx10!sid243404@id-243404.helmsley.irccloud.com
For Cross Compiling zig to illumos I think this IPD would probably help?  https://github.com/pfmooney/ipd/blob/ipd0059/ipd/0059/README.adoc

1767888637
cow_2001!~username@user/cow-2001/x-5712099
inline for loop inline for pound

1767895751
mimivalsi!~mimivalsi@user/MimiValsi
ffs, weechat went down. Don't know if I get some answers here ^^'

1767895865
clevor!sid649024@id-649024.hampstead.irccloud.com
mimivalsi: You didn't miss much. https://usercontent.irccloud-cdn.com/file/WpQCckO1/image.png

1767896011
mimivalsi!~mimivalsi@user/MimiValsi
oh cool, thx

1767897446
smlavine!~smlavine@sourcehut/user/smlavine
Looking forward to 0.16 finishing baking -- the kitchen smells good :)

1767898521
rvrb!~rvrb@156.146.51.229
it's pretty fun to mess with tbh

1767898535
rvrb!~rvrb@156.146.51.229
loving some of the changes to process APIs and so on

1767899594
mimivalsi!~mimivalsi@user/MimiValsi
It seems that std.Io has changed placed?

1767900021
mimivalsi!~mimivalsi@user/MimiValsi
where can I find the last changes? Zig std? or must read the main codeberg repo?

1767900055
rvrb!~rvrb@156.146.51.229
the std docs are kept update to date https://ziglang.org/documentation/master/std/

1767900323
bblack!~bblack@wikimedia/bblack-WMF
it can be quite daunting, adapting code forward to the new-new std.Io, but quite rewarding as well

1767900340
bblack!~bblack@wikimedia/bblack-WMF
every commit, I lose net lines of code.  a lot of them :)

1767900402
bblack!~bblack@wikimedia/bblack-WMF
I imagine someone will a write a howto guide for the transition

1767901656
rvrb!~rvrb@156.146.51.229
I don't care if it has bugs/missing functionality/perf pitfalls now, but is std.http.Client intended to be feature complete/production ready/good enough for building on top of as the foundation for HTTP requests in the future?

1767901671
andrewrk!~andrewrk@mail.ziglang.org
rvrb: yes

1767901680
rvrb!~rvrb@156.146.51.229
nice

1767903320
slowstatic!~slowstati@user/slowstatic
The theme of 0.16 is mostly std.Io changes, is there an expected theme for 0.17?

1767903611
andrewrk!~andrewrk@mail.ziglang.org
fuzzing & incremental

1767903627
andrewrk!~andrewrk@mail.ziglang.org
aarch64 backend

1767903634
andrewrk!~andrewrk@mail.ziglang.org
https://ziglang.org/download/0.15.1/release-notes.html#Roadmap

1767903814
andrewrk!~andrewrk@mail.ziglang.org
maybe compiler server

1767904848
mimivalsi!~mimivalsi@user/MimiValsi
Is there a fonction in Zig that decode a float number, e.g. 3.14159, into binary? So it can be sent to pgsql db?

1767905611
andrewrk!~andrewrk@mail.ziglang.org
https://ziglang.org/documentation/master/std/#std.fmt.parseFloat

1767906056
mimivalsi!~mimivalsi@user/MimiValsi
andrewk: Oh thx. I think I used this one before. :o but s is []const u8 and my variable is f32. Interesting challenge

1767906103
andrewrk!~andrewrk@mail.ziglang.org
I don't understand

1767906479
mimivalsi!~mimivalsi@user/MimiValsi
^^ yh me neither. I suppose that I need to send a binary format of my float number to pgsql via the socket. I could send as text but I want the harder one. I won't bother now. Need sleep. ^^' thx for the time

1767906541
slowstatic!~slowstati@user/slowstatic
ah cool thanks for the roadmap link

1767907247
andrewrk!~andrewrk@mail.ziglang.org
mimivalsi: I'm happy to help, I just need to understand your input and your output better. I don't know what formats you are talking about

1767907526
clevor!sid649024@id-649024.hampstead.irccloud.com
mimivalsi: If I understand what you're asking correctly, @bitCast the float to a u32 and write it.

1767907959
bblack!~bblack@wikimedia/bblack-WMF
I've puzzled on the similar issue for the reading side as well.  There's no std.mem.readFloat(), basically, but you can readInt() an equivalent bit-size and then bitcast it

1767908004
bblack!~bblack@wikimedia/bblack-WMF
(for f32 and f64 anyways, don't ask me about f80)

1767908405
andrewrk!~andrewrk@mail.ziglang.org
bitcast operates on bits so you can bitcast from a u80

1767910538
bblack!~bblack@wikimedia/bblack-WMF
I feel like I've been mentally glossing-over how similar/swappable Io.Threaded and Io.Evented are

1767910569
andrewrk!~andrewrk@mail.ziglang.org
that's the point! :D

1767910605
bblack!~bblack@wikimedia/bblack-WMF
I mean, I get they share the same interface and vtables of potential operations

1767910707
bblack!~bblack@wikimedia/bblack-WMF
but I guess I need to dig into the details of Io.Evented more to understand, why my outer program structure could stay all the same if sub one in for the other

1767910829
bblack!~bblack@wikimedia/bblack-WMF
I suspect in those details, I might end up finding that while an Io.Evented can be implement on IoUring, it can't be implemented over something as simplistic as poll()

1767910932
bblack!~bblack@wikimedia/bblack-WMF
the parts I've been glossing over the is the fibers and "idle"

1767911084
bblack!~bblack@wikimedia/bblack-WMF
and related things like what a mutex really means in evented vs threaded

1767911224
bblack!~bblack@wikimedia/bblack-WMF
in the world of Evented, if I have two concurrents running... if one of them locks an Io.mutex and then does some other operations, other fiber context switches could happen, but not into a "thread" that's blocked on that same mutex?

1767911364
bblack!~bblack@wikimedia/bblack-WMF
mutexes still have their same semantic meaning in essence, as they would in Threaded

1767911476
andrewrk!~andrewrk@mail.ziglang.org
that's correct, an Io.Mutex does something different in Threaded vs Evented, but with respect to a single Io instance, the semantics are equivalent

1767911543
bblack!~bblack@wikimedia/bblack-WMF
ok, so fundamentally, if I wrote a bunch of applayer code using std.Io, and was using a Threaded kind of mental model... if I later swapped in Evented, everything should Just Work (obviously, it may scale and perform differently, but it should still function correctly)?

1767911577
andrewrk!~andrewrk@mail.ziglang.org
exactly

1767911591
bblack!~bblack@wikimedia/bblack-WMF
that's what I initially naively assumed a while back, but then today I started really questioning it :)

1767911600
bblack!~bblack@wikimedia/bblack-WMF
got it, thanks :)

1767911617
andrewrk!~andrewrk@mail.ziglang.org
and that's why we've been careful and precise with, for example, the meaning of async vs concurrent 

1767911626
bblack!~bblack@wikimedia/bblack-WMF
yeah, totally

1767911669
bblack!~bblack@wikimedia/bblack-WMF
and in Evented the two are basically aliases, right?

1767911722
bblack!~bblack@wikimedia/bblack-WMF
oh yeah, I see.  IoUring.async() just calls .concurrent() :)

1767911763
bblack!~bblack@wikimedia/bblack-WMF
fascinating

1767911839
andrewrk!~andrewrk@mail.ziglang.org
yes, but, crucially, it is allowed to handle error by directly calling the function

1767911892
bblack!~bblack@wikimedia/bblack-WMF
right, because even with Evented there will be concurrency limits, imposed by something about size of some IoUring structures or whatever

1767911908
bblack!~bblack@wikimedia/bblack-WMF
or whatever limitations exist at that level

1767911929
andrewrk!~andrewrk@mail.ziglang.org
exactly

1767911939
andrewrk!~andrewrk@mail.ziglang.org
well also there's allocating a stack for the function to be called

1767911946
bblack!~bblack@wikimedia/bblack-WMF
right, the fiber stuff

1767914328
clevor!sid649024@id-649024.hampstead.irccloud.com
andrewrk: I will work on the eZ80 PR after I refactor narser to modify UnpackIterator and add PackIterator, but first, I have to submit a Zig bug :p

1767915290
Franciman!~Franciman@mx1.fracta.dev
thanks so much people for helping mold our reality

1767915306
Franciman!~Franciman@mx1.fracta.dev
I wish you the best luck, I'll leave for a bit

1767915320
Franciman!~Franciman@mx1.fracta.dev
so well, I thought it's a good moment to thank you for the great job

1767915414
rvrb!~rvrb@156.146.51.229
Franciman: I feel like I am missing context

1767915445
Franciman!~Franciman@mx1.fracta.dev
the great job on Zig

1767915461
Franciman!~Franciman@mx1.fracta.dev
i'm leaving the channel for a while, but I highly appreciate your work

1767915553
andrewrk!~andrewrk@mail.ziglang.org
bye Franciman, enjoy showing the world your francipants 

1767915565
andrewrk!~andrewrk@mail.ziglang.org
(I'm just assuming you're walking out the door with fancy pants on)

1767915582
Franciman!~Franciman@mx1.fracta.dev
:) thanks andrewrk , you made me smile in a difficult period

1767915585
Franciman!~Franciman@mx1.fracta.dev
ALL THE BEST PPL!

